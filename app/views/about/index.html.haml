.vcard

  %h1 General Info

  .gravatar
    = image_tag "http://gravatar.com/avatar/#{@gravatar_id}.png?s=150", :class => 'photo', :alt => 'tekniklr'

  %dl.info
    - cache @who do
      = facet_print @who
    - cache @location do
      = facet_print @location, 'adr'
    - cache @interests do
      = facet_print @interests
    - cache @twitter do
      = facet_print @twitter
    - cache @messaging do
      = facet_print @messaging
    %dt Also available on
    %dd
      - cache @about_links do
        - @about_links.each do |link|
          - link == @about_links.last ? sep = '' : sep = ', '
          = link_to(link.name, link.url) + sep
  
  %h1 Stuff I like
  %dl.favorites
    - @favorites.each do |favorite|
      - cache [favorite.favorite_things, @things] do
        %dt #{favorite.favorite_type}
        - if !favorite.favorite_things.any?{|t| @things && @things.keys.include?(t.thing)}
          %dd
            - favorite.favorite_things.each do |thing|
              - thing == favorite.favorite_things.last ? sep = '' : sep = '  â˜† '
              = (!thing.link.blank? ? link_to(thing.thing, thing.link) : thing.thing) + sep
        - else
          %dd.spacey
            %ul
              - favorite.favorite_things.each do |thing|
                %li{:class => (thing == favorite.favorite_things.last) ? '' : 'separated'}
                  = (!thing.link.blank? ? link_to(thing.thing, thing.link) : thing.thing)
                  - if @things[thing.thing]
                    %br
                    - 
                    - if @things[thing.thing][:similarity] >= SIMILAR_THRESHOLD && !@things[thing.thing][:amazon_url].blank?
                      = link_to(image_tag(@things[thing.thing][:image_url], :alt => thing.thing, :title => thing.thing), @things[thing.thing][:amazon_url])
                    - elsif !@things[thing.thing][:image_url].blank?
                      = image_tag(@things[thing.thing][:image_url], :alt => thing.thing, :title => thing.thing)
                      